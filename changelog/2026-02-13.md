# Changelog - 2026-02-13

## 新增
- **测试数据**: 创建 `data/toy.fa`（3 contig 参考序列）和 `data/toy_reads.fq`（8 条覆盖各场景的 reads）
- **FMIndex 版本控制**: 添加 magic number (`0x424D_4146_4D5F5253`) 和 version (`1`) 字段，加载时进行兼容性校验
- **score_threshold**: `AlignOpt` 新增 `score_threshold` 字段（默认 20），CLI 新增 `--score-threshold` 参数，低分对齐标记为 unmapped
- **FM 模块测试**: 新增 7 个测试（build/search/save-load roundtrip/map_text_pos/occ 正确性/sa_interval_positions）
- **DNA 模块测试**: 新增 3 个测试（revcomp roundtrip/normalize 未知字符/字母表完整映射）
- **Align 模块测试**: 新增 7 个测试（SW deletion/empty inputs/all mismatch/端到端 exact match/mismatch 对齐/chain_to_alignment 边界/MAPQ 边界）
- **.gitignore**: 创建项目级 `.gitignore`，排除 `target/`、IDE 文件、OS 文件、`.fm` 索引文件

## 修复
- **SW 回溯 I/D 标签错误**: `banded_sw` 回溯时 `'I'`（插入）和 `'D'`（缺失）标签互换，导致 CIGAR 语义错误和 NM 计算越界崩溃
- **编译警告清理**: 移除 `sa.rs` 中未使用的 `std::cmp::Ordering` 导入、`fastq.rs` 中不必要的 `mut`、`align/mod.rs` 中未使用的 `up_idx`/`left_idx` 变量

## 优化
- **移除无用代码**: 删除未使用的 `align_fastq` 函数和 `MAX_SEED_HITS` 常量
- **Git 清理**: 从 git 跟踪中移除 `bwa-rust/target/` 目录

## 改进
- **README.md**: 更新项目说明、已实现功能列表、快速开始、索引格式简介、项目结构
- **run_index 错误处理**: 增加空 FASTA / 空序列检查，改进文件操作错误信息
- **ROADMAP.md**: 标记阶段 0/1/2 中已完成条目
